### 索引相关

##### 回表

##### 1.什么是回表：回表是指Mysql查询时先通过普通索引定位到所需数据的主键，再通过主键的聚簇索引定位到所需数据。
##### 举个例子：
```select name, age from table where name='abc'```
##### 我们假设查询的表table的唯一主键字段是id，name和age字段各自有一个索引。那么这条sql语句的执行过程就是：先通过name的索引确定name='abc'的数据的主键，再通过主键查询该行数据，取出age的值，然后返回。
##### 我们可以看到，MySQL在查询的过程中，做了一次先使用普通索引定位聚簇索引，再使用聚簇索引得到数据行的操作。事实上MySQL在做查询操作时，这样的步骤可以说是常态，但这样的步骤，确确实实的走了两边扫描，通过第二遍聚簇索引得到数据行的过程，就叫做回表。

##### 2.如何避免回表：
##### 答案是  索引覆盖(Covering index)。在我们查看MySQL的查询计划explain时，如果explain的Extra字段为Using index，则说明触发了索引覆盖。覆盖索引是指在有联合索引的情况下，sql语句查询的字段都在联合索引的范围内，此时MySQL将直接返回索引结果作为最终结果，不再进行回表查询。
##### 还是上面那个例子，我们假设存在(name, age)这一联合索引，此时sql语句的执行过程中就会变成，查询(name，age)的联合索引，此时索引的叶子节点上有name，age的索引值，由两个索引值确定的结果集就是我们需要的结果集，此时已经不需要再通过主键重新扫描一遍再取出结果，MySQL直接返回索引值作为结果。
##### 在绝大多数的查询中，我们都不需要担心回表，因为在数据量不那么大的时候，回表的查询消耗是可以忽略不计的。不过在数据量足够大，回表的带来的扫描时间已经足够久的时候，我们就可以考虑将某些频繁sql的索引合并为联合索引，通过索引覆盖来减少回表时间，达到优化查询语句的目的。